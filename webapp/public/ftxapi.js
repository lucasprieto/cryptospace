!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ftxapi=t():e.ftxapi=t()}(self,(function(){return(()=>{var e={856:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(997),t),n(r(797),t)},753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultLogger=void 0,t.DefaultLogger={silly:(...e)=>{console.log(e)},debug:(...e)=>{console.log(e)},notice:(...e)=>{console.log(e)},info:(...e)=>{console.info(e)},warning:(...e)=>{console.error(e)},error:(...e)=>{console.error(e)}}},997:function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((s=s.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RestClient=void 0;const i=r(821),o=n(r(31));t.RestClient=class{constructor(e,t,r={},s={}){return this.requestWrapper=new o.default(e,t,i.getRestBaseUrl(r),r,s),this}getSubaccounts(){return this.requestWrapper.get("subaccounts")}createSubaccount(e){return this.requestWrapper.post("subaccounts",{nickname:e})}changeSubaccountName(e){return this.requestWrapper.post("subaccounts/update_name",e)}deleteSubaccount(e){return this.requestWrapper.delete("subaccounts",{nickname:e})}getSubaccountBalances(e){return this.requestWrapper.get(`subaccounts/${e}/balances`)}transferBetweenSubaccounts(e){return this.requestWrapper.post("subaccounts/transfer",e)}getMarkets(){return this.requestWrapper.get("markets")}getMarket(e){return this.requestWrapper.get(`markets/${e}`)}getOrderbook(e){const t=e.depth?`?depth=${e.depth}`:"";return this.requestWrapper.get(`markets/${e.marketName}/orderbook${t}`)}getTrades(e){return this.requestWrapper.get(`markets/${e.market_name}/trades`,e)}getHistoricalPrices(e){return this.requestWrapper.get(`markets/${e.market_name}/candles`,e)}listAllFutures(){return this.requestWrapper.get("futures")}getFuture(e){return this.requestWrapper.get(`futures/${e}`)}getFutureStats(e){return this.requestWrapper.get(`futures/${e}/stats`)}getFundingRates(){return this.requestWrapper.get("funding_rates")}getIndexWeights(e){return this.requestWrapper.get(`indexes/${e}/weights`)}getExpiredFutures(){return this.requestWrapper.get("expired_futures")}getHistoricalIndex(e){return this.requestWrapper.get(`indexes/${e.marketName}/candles`,e)}getAccount(){return this.requestWrapper.get("account")}getPositions(e){const t=e?"?showAvgPrice=true":"";return this.requestWrapper.get(`positions${t}`)}setAccountLeverage(e){return this.requestWrapper.post("account/leverage",{leverage:e})}getCoins(){return this.requestWrapper.get("wallet/coins")}getBalances(){return this.requestWrapper.get("wallet/balances")}getBalancesAllAccounts(){return this.requestWrapper.get("wallet/all_balances")}getDepositAddress(e){const t=e.method?`?method=${e.method}`:"";return this.requestWrapper.get(`wallet/deposit_address/${e.coin}${t}`)}getDepositHistory(e){return this.requestWrapper.get("wallet/deposits",e)}getWithdrawalHistory(e){return this.requestWrapper.get("wallet/withdrawals",e)}requestWithdrawal(e){return this.requestWrapper.post("wallet/withdrawals",e)}getAirdrops(e){return this.requestWrapper.get("wallet/airdrops",e)}getSavedAddresses(e){return this.requestWrapper.get("wallet/saved_addresses",{coin:e})}createSavedAddress(e){return this.requestWrapper.post("wallet/saved_addresses",e)}deleteSavedAddress(e){return this.requestWrapper.delete(`wallet/saved_addresses/${e}`)}getOpenOrders(e){const t=e?`?market=${e}`:"";return this.requestWrapper.get(`orders${t}`)}getOrderHistory(e){return this.requestWrapper.get("orders/history",e)}getOpenTriggerOrders(e){return this.requestWrapper.get("conditional_orders",e)}getTriggerOrderTriggers(e){return this.requestWrapper.get(`conditional_orders/${e}/triggers`)}getTriggerOrderHistory(e){return this.requestWrapper.get("orders",e)}placeOrder(e){return this.requestWrapper.post("orders",e)}placeTriggerOrder(e){return this.requestWrapper.post("conditional_orders",e)}modifyOrder(e){return this.requestWrapper.post(`orders/${e.orderId}/modify`,{size:e.size,price:e.price,clientId:e.clientId})}modifyOrderByClientId(e,t){return this.requestWrapper.post(`orders/by_client_id/${e}/modify`,t)}modifyTriggerOrder(e,t){return this.requestWrapper.post(`conditional_orders/${e}/modify`,t)}getOrderStatus(e){return this.requestWrapper.get(`orders/${e}`)}getOrderStatusByClientId(e){return this.requestWrapper.get(`orders/by_client_id/${e}`)}cancelOrder(e){return this.requestWrapper.delete(`orders/${e}`)}cancelOrderByClientId(e){return this.requestWrapper.delete(`orders/by_client_id/${e}`)}cancelOpenTriggerOrder(e){return this.requestWrapper.delete(`conditional_orders/${e}`)}cancelAllOrders(e){return this.requestWrapper.delete("orders",e)}requestQuote(e){return this.requestWrapper.post("otc/quotes",e)}getQuoteStatus(e,t){const r=t?`?market=${t}`:"";return this.requestWrapper.get(`otc/quotes/${e}${r}`)}acceptQuote(e){return this.requestWrapper.post(`otc/quotes/${e}/accept`)}getBorrowRates(){return this.requestWrapper.get("spot_margin/borrow_rates")}getLendingRates(){return this.requestWrapper.get("spot_margin/lending_rates")}getDailyBorrowedAmounts(){return this.requestWrapper.get("spot_margin/borrow_summary")}getMarketInfo(e){const t=e?`?market=${e}`:"";return this.requestWrapper.get(`spot_margin/market_info${t}`)}getBorrowHistory(){return this.requestWrapper.get("spot_margin/borrow_history")}getLendingHistory(){return this.requestWrapper.get("spot_margin/lending_history")}getLendingOffers(){return this.requestWrapper.get("spot_margin/offers")}getLendingInfo(){return this.requestWrapper.get("spot_margin/lending_info")}submitLendingOffer(e){return this.requestWrapper.post("spot_margin/offers",e)}getFills(e){return this.requestWrapper.get("fills",e)}getFundingPayments(e){return this.requestWrapper.get("funding_payments",e)}listLeveragedTokens(){return this.requestWrapper.get("lt/tokens")}getLeveragedTokenInfo(e){return this.requestWrapper.get(`lt/${e}`)}getLeveragedTokenBalances(){return this.requestWrapper.get("lt/balances")}listLeveragedTokenCreationRequests(){return this.requestWrapper.get("lt/creations")}requestLeveragedTokenCreation(e,t){return this.requestWrapper.post(`lt/${e}`,{size:t})}listLeveragedTokenRedemptionRequests(){return this.requestWrapper.get("lt/redemptions")}requestLeveragedTokenRedemption(e,t){return this.requestWrapper.post(`lt/${e}/redeem`,{size:t})}listQuoteRequests(){return this.requestWrapper.get("options/requests")}getMyQuoteRequests(){return this.requestWrapper.get("options/my_requests")}createQuoteRequest(e){return this.requestWrapper.post("options/requests",e)}cancelQuoteRequest(e){return this.requestWrapper.delete(`options/requests/${e}`)}getQuotesForQuoteRequest(e){return this.requestWrapper.get(`options/requests/${e}/quotes`)}createQuote(e,t){return this.requestWrapper.post(`options/requests/${e}`,{price:t})}getMyQuotes(){return this.requestWrapper.get("options/my_quotes")}cancelQuote(e){return this.requestWrapper.delete(`options/quotes/${e}`)}acceptOptionsQuote(e){return this.requestWrapper.post(`options/quotes/${e}/accept`)}getOptionsAccountInfo(){return this.requestWrapper.get("options/account_info")}getOptionsPositions(){return this.requestWrapper.get("options/positions")}getPublicOptionsTrades(e){return this.requestWrapper.get("options/trades",e)}getOptionsFills(e){return this.requestWrapper.get("options/fills",e)}get24hOptionVolume(){return this.requestWrapper.get("options/24h_options_volume")}getOptionsHistoricalVolumes(e){return this.requestWrapper.get("options/historical_volumes/BTC",e)}getOptionsOpenInterest(){return this.requestWrapper.get("options/open_interest/BTC")}getOptionsHistoricalOpenInterest(e){return this.requestWrapper.get("options/historical_open_interest/BTC",e)}getStakes(){return this.requestWrapper.get("staking/stakes")}getUnstakeRequests(){return this.requestWrapper.get("staking/unstake_requests")}getStakeBalances(){return this.requestWrapper.get("staking/balances")}createUnstakeRequest(e,t){return this.requestWrapper.post("staking/unstake_requests",{coin:e,size:t})}cancelUnstakeRequest(e){return this.requestWrapper.delete(`staking/unstake_requests/${e}`)}getStakingRewards(){return this.requestWrapper.get("staking/staking_rewards")}createStakeRequest(e,t){return this.requestWrapper.post("staking/stakes",{coin:e,size:t})}getServerTime(){return this.requestWrapper.get("https://otc.ftx.com/api/time")}getApiKeyInfo(){return this.requestWrapper.get("api_key_status")}getTimeOffset(){return s(this,void 0,void 0,(function*(){const e=Date.now();try{const t=yield this.getServerTime(),r=new Date(t.result).getTime(),s=Date.now();return Math.ceil(r-s+(s-e)/2)}catch(e){return 0}}))}}},470:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(797),n=r(753);function i(e,t){for(const r in e)if(e[r]!==t[r])return!1;return!0}t.default=class{constructor(e){this.logger=e||n.DefaultLogger,this.wsState={}}get(e,t){return this.wsState[e]?this.wsState[e]:t?this.create(e):void 0}getKeys(){return Object.keys(this.wsState)}create(e){return this.hasExistingActiveConnection(e)&&this.logger.warning("WsStore setConnection() overwriting existing open connection: ",this.getWs(e)),this.wsState[e]={subscribedTopics:new Set,connectionState:s.WsConnectionState.READY_STATE_INITIAL},this.get(e)}delete(e){if(this.hasExistingActiveConnection(e)){const t=this.getWs(e);this.logger.warning("WsStore deleting state for connection still open: ",t),null==t||t.close()}delete this.wsState[e]}hasExistingActiveConnection(e){return this.get(e)&&this.isWsOpen(e)}getWs(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.ws}setWs(e,t){return this.isWsOpen(e)&&this.logger.warning("WsStore setConnection() overwriting existing open connection: ",this.getWs(e)),this.get(e,!0).ws=t,t}isWsOpen(e){const t=this.getWs(e);return!!t&&t.readyState===t.OPEN}getConnectionState(e){return this.get(e,!0).connectionState}setConnectionState(e,t){this.get(e,!0).connectionState=t}isConnectionState(e,t){return this.getConnectionState(e)===t}getTopics(e){return this.get(e,!0).subscribedTopics}getTopicsByKey(){const e={};for(const t in this.wsState)e[t]=this.getTopics(t);return e}getMatchingTopic(e,t){if("string"==typeof t)return this.getMatchingTopic(e,{channel:t});const r=this.getTopics(e).values();for(const e of r)if(i(t,e))return e}addTopic(e,t){return"string"==typeof t?this.addTopic(e,{channel:t}):this.getMatchingTopic(e,t)?this.getTopics(e):this.getTopics(e).add(t)}deleteTopic(e,t){const r=this.getMatchingTopic(e,t);return r&&this.getTopics(e).delete(r),this.getTopics(e)}}},42:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((s=s.apply(e,t||[])).next())}))};function s(e,t){return r(this,void 0,void 0,(function*(){const r=new TextEncoder,s=yield window.crypto.subtle.importKey("raw",r.encode(t),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=yield window.crypto.subtle.sign("HMAC",s,r.encode(e));return Array.prototype.map.call(new Uint8Array(n),(e=>("00"+e.toString(16)).slice(-2))).join("")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.signWsAuthenticate=t.signMessage=void 0,t.signMessage=s,t.signWsAuthenticate=function(e,t){return r(this,void 0,void 0,(function*(){return s(e+"websocket_login",t)}))}},821:(e,t)=>{"use strict";function r(e={},t=!1){return Object.keys(e).sort().map((r=>{const s=e[r];if(!0===t&&void 0===s)throw new Error("Failed to sign API request due to undefined parameter");return`${r}=${s}`})).join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicEndpoint=t.getWsUrl=t.getRestBaseUrl=t.programKey=t.programId=t.serializeParamPayload=t.serializeParams=void 0,t.serializeParams=r,t.serializeParamPayload=function(e,t,s){return t?e?"string"==typeof t?"?"+t:"?"+r(t,s):JSON.stringify(t):""},t.programId="ftxnodeapi",t.programKey="externalReferralProgram",t.getRestBaseUrl=function(e){return e.baseUrl?e.baseUrl:"ftxus"===e.domain?"https://ftx.us/api":"https://ftx.com/api"},t.getWsUrl=function(e){return e.wsUrl?e.wsUrl:"ftxus"===e.domain?"wss://ftx.us/ws/":"wss://ftx.com/ws/"},t.isPublicEndpoint=function(e){return!!e.startsWith("https")||!!e.startsWith("v2/public")||!!e.startsWith("public/linear")}},31:function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((s=s.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(868)),o=r(42),a=r(821),u=(e,t="ftxcom")=>{if("ftxcom"===t)switch(e){case"key":return"FTX-KEY";case"ts":return"FTX-TS";case"sign":return"FTX-SIGN";case"subaccount":return"FTX-SUBACCOUNT"}if("ftxus"===t)switch(e){case"key":return"FTXUS-KEY";case"ts":return"FTXUS-TS";case"sign":return"FTXUS-SIGN";case"subaccount":return"FTXUS-SUBACCOUNT"}return console.warn("No matching header name: ",{headerId:e,domain:t}),"null"};t.default=class{constructor(e,t,r,s={},n={}){if(this.timeOffset=null,this.syncTimePromise=null,this.options=Object.assign({recv_window:5e3,sync_interval_ms:36e5,strict_param_validation:!1},s),this.globalRequestOptions=Object.assign({timeout:3e5,headers:{}},n),"string"==typeof e&&(this.globalRequestOptions.headers[u("key",s.domain)]=e),"string"==typeof this.options.subAccountName&&(this.globalRequestOptions.headers[u("subaccount",s.domain)]=this.options.subAccountName),this.baseUrl=r,e&&!t)throw new Error("API Key & Secret are both required for private endpoints");!0!==this.options.disable_time_sync&&(this.syncTime(),setInterval(this.syncTime.bind(this),+this.options.sync_interval_ms)),this.key=e,this.secret=t}get(e,t){return this._call("GET",e,t)}post(e,t){return this._call("POST",e,Object.assign(Object.assign({},t),{[a.programKey]:a.programId}))}delete(e,t){return this._call("DELETE",e,t)}_call(e,t,r){return s(this,void 0,void 0,(function*(){const s=Object.assign(Object.assign({},this.globalRequestOptions),{method:e,json:!0});s.url=t.startsWith("https")?t:[this.baseUrl,t].join("/");const n="GET"===e,o=a.serializeParamPayload(n,r,this.options.strict_param_validation);if(this.key&&this.secret){null!==this.timeOffset||this.options.disable_time_sync||(yield this.syncTime());const{timestamp:r,sign:n}=yield this.getRequestSignature(e,t,this.secret,o);s.headers[u("ts",this.options.domain)]=String(r),s.headers[u("sign",this.options.domain)]=n}return n?s.url+=o:s.data=r,i.default(s).then((e=>{if(200==e.status)return e.data;throw e})).catch((e=>this.parseException(e)))}))}parseException(e){if(!1===this.options.parse_exceptions)throw e;if(!e.response){if(!e.request)throw e.message;throw e}const t=e.response;throw{code:t.status,message:t.statusText,body:t.data,headers:t.headers,requestOptions:this.options}}getRequestSignature(e,t,r,n=""){return s(this,void 0,void 0,(function*(){const s=Date.now()+(this.timeOffset||0);if(!r)return{timestamp:s,sign:""};const i=`${s}${e}/api/${t}${n}`;return{timestamp:s,sign:yield o.signMessage(i,r)}}))}signRequest(e){const t=Object.assign(Object.assign({},e),{api_key:this.key,timestamp:Date.now()+(this.timeOffset||0)});if(this.options.recv_window&&!t.recv_window&&(t.recv_window=this.options.recv_window),this.key&&this.secret){const e=a.serializeParams(t,this.options.strict_param_validation);t.sign=o.signMessage(e,this.secret)}return t}syncTime(){return!0===this.options.disable_time_sync?Promise.resolve(!1):(null!==this.syncTimePromise||(this.syncTimePromise=this.getTimeOffset().then((e=>{this.timeOffset=e,this.syncTimePromise=null}))),this.syncTimePromise)}getTimeOffset(){return s(this,void 0,void 0,(function*(){const e=Date.now();try{const t=yield this.get("https://otc.ftx.com/api/time"),r=new Date(t.result).getTime(),s=Date.now();return Math.ceil(r-s+(s-e)/2)}catch(e){return 0}}))}}},38:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWsPong=t.getWsPingMessage=t.getWsAuthMessage=void 0,t.getWsAuthMessage=function(e,t,r,s){const n={op:"login",args:{key:e,sign:t,time:r}};return s&&(n.args.subaccount=s),n},t.getWsPingMessage=function(){return{op:"ping"}},t.isWsPong=function(e){return"pong"===(null==e?void 0:e.type)}},797:function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((s=s.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketClient=t.wsKeyGeneral=t.WsConnectionState=void 0;const i=r(939),o=r(997),a=r(753),u=r(821),c=n(r(768)),p=n(r(470)),h=r(38),l=r(42),f={category:"ftx-ws"};var d;(d=t.WsConnectionState||(t.WsConnectionState={}))[d.READY_STATE_INITIAL=0]="READY_STATE_INITIAL",d[d.READY_STATE_CONNECTING=1]="READY_STATE_CONNECTING",d[d.READY_STATE_CONNECTED=2]="READY_STATE_CONNECTED",d[d.READY_STATE_CLOSING=3]="READY_STATE_CLOSING",d[d.READY_STATE_RECONNECTING=4]="READY_STATE_RECONNECTING",t.wsKeyGeneral="ftx";class g extends i.EventEmitter{constructor(e,t){var r;super(),this.logger=t||a.DefaultLogger,this.wsStore=new p.default(this.logger),this.options=Object.assign({pongTimeout:1e3,pingInterval:1e4,reconnectTimeout:500},e),e.domain!=(null===(r=this.options.restOptions)||void 0===r?void 0:r.domain)&&(this.options.restOptions=Object.assign(Object.assign({},this.options.restOptions),{domain:e.domain})),this.restClient=new o.RestClient(void 0,void 0,this.options.restOptions,this.options.requestOptions)}isLivenet(){return!0}subscribe(e){const t=(Array.isArray(e)?e:[e]).map((e=>"string"==typeof e?{channel:e}:e));t.forEach((e=>this.wsStore.addTopic(this.getWsKeyForTopic(e),e))),this.wsStore.getKeys().forEach((e=>this.wsStore.isConnectionState(e,2)?this.requestSubscribeTopics(e,t):this.wsStore.isConnectionState(e,1)||this.wsStore.isConnectionState(e,4)?void 0:this.connect(e)))}unsubscribe(e){const t=(Array.isArray(e)?e:[e]).map((e=>"string"==typeof e?{channel:e}:e));t.forEach((e=>this.wsStore.deleteTopic(this.getWsKeyForTopic(e),e))),this.wsStore.getKeys().forEach((e=>{this.wsStore.isConnectionState(e,2)&&this.requestUnsubscribeTopics(e,t)}))}close(e){var t;this.logger.info("Closing connection",Object.assign(Object.assign({},f),{wsKey:e})),this.setWsState(e,3),this.clearTimers(e),null===(t=this.getWs(e))||void 0===t||t.close()}connectAll(){return[this.connect(t.wsKeyGeneral)]}connect(e){return s(this,void 0,void 0,(function*(){try{if(this.wsStore.isWsOpen(e))return this.logger.error("Refused to connect to ws with existing active connection",Object.assign(Object.assign({},f),{wsKey:e})),this.wsStore.getWs(e);if(this.wsStore.isConnectionState(e,1))return void this.logger.error("Refused to connect to ws, connection attempt already active",Object.assign(Object.assign({},f),{wsKey:e}));this.wsStore.getConnectionState(e)&&!this.wsStore.isConnectionState(e,0)||this.setWsState(e,1);const t=u.getWsUrl(this.options),r=this.connectToWsUrl(t,e);return this.wsStore.setWs(e,r)}catch(t){this.parseWsError("Connection failed",t,e),this.reconnectWithDelay(e,this.options.reconnectTimeout)}}))}requestTryAuthenticate(e){return s(this,void 0,void 0,(function*(){const{key:t,secret:r,subAccountName:s}=this.options;if(!t||!r)return void this.logger.debug(`Connection "${e}" will remain unauthenticated due to missing key/secret`);const n=(new Date).getTime(),i=h.getWsAuthMessage(t,yield l.signWsAuthenticate(n,r),n,s);this.tryWsSend(e,JSON.stringify(i))}))}parseWsError(e,t,r){if(t.message)switch(t.message){case"Unexpected server response: 401":this.logger.error(`${e} due to 401 authorization failure.`,Object.assign(Object.assign({},f),{wsKey:r}));break;default:this.logger.error(`{context} due to unexpected response error: ${t.msg}`,Object.assign(Object.assign({},f),{wsKey:r}))}else this.logger.error(`${e} due to unexpected error: `,t)}getAuthParams(e){return s(this,void 0,void 0,(function*(){const{key:t,secret:r}=this.options;if(t&&r){this.logger.debug("Getting auth'd request params",Object.assign(Object.assign({},f),{wsKey:e}));const t=yield this.restClient.getTimeOffset(),s={api_key:this.options.key,expires:Date.now()+t+5e3};return s.signature=l.signMessage("GET/realtime"+s.expires,r),s}return t&&r?this.logger.debug("Starting public only websocket client.",Object.assign(Object.assign({},f),{wsKey:e})):this.logger.warning("Connot authenticate websocket, either api or private keys missing.",Object.assign(Object.assign({},f),{wsKey:e})),""}))}reconnectWithDelay(e,t){this.clearTimers(e),1!==this.wsStore.getConnectionState(e)&&this.setWsState(e,4),setTimeout((()=>{this.logger.info("Reconnecting to websocket",Object.assign(Object.assign({},f),{wsKey:e})),this.connect(e)}),t)}ping(e){this.clearPongTimer(e),this.logger.silly("Sending ping",Object.assign(Object.assign({},f),{wsKey:e})),this.tryWsSend(e,JSON.stringify({op:"ping"})),this.wsStore.get(e,!0).activePongTimer=setTimeout((()=>{var t;this.logger.info("Pong timeout - closing socket to reconnect",Object.assign(Object.assign({},f),{wsKey:e})),null===(t=this.getWs(e))||void 0===t||t.close()}),this.options.pongTimeout)}clearTimers(e){this.clearPingTimer(e),this.clearPongTimer(e)}clearPingTimer(e){const t=this.wsStore.get(e);(null==t?void 0:t.activePingTimer)&&(clearInterval(t.activePingTimer),t.activePingTimer=void 0)}clearPongTimer(e){const t=this.wsStore.get(e);(null==t?void 0:t.activePongTimer)&&(clearTimeout(t.activePongTimer),t.activePongTimer=void 0)}requestSubscribeTopics(e,t){t.forEach((t=>{const r=JSON.stringify(Object.assign({op:"subscribe"},t));this.tryWsSend(e,r)}))}requestUnsubscribeTopics(e,t){t.forEach((t=>{const r=JSON.stringify(Object.assign({op:"unsubscribe"},t));this.tryWsSend(e,r)}))}tryWsSend(e,t){var r;try{if(this.logger.silly("Sending upstream ws message: ",Object.assign(Object.assign({},f),{wsMessage:t,wsKey:e})),!e)throw new Error("Cannot send message due to no known websocket for this wsKey");null===(r=this.getWs(e))||void 0===r||r.send(t)}catch(r){this.logger.error("Failed to send WS message",Object.assign(Object.assign({},f),{wsMessage:t,wsKey:e,exception:r}))}}connectToWsUrl(e,t){this.logger.silly(`Opening WS connection to URL: ${e}`,Object.assign(Object.assign({},f),{wsKey:t}));const r=new c.default(e);return r.onopen=e=>this.onWsOpen(e,t),r.onmessage=e=>this.onWsMessage(e,t),r.onerror=e=>this.onWsError(e,t),r.onclose=e=>this.onWsClose(e,t),r}onWsOpen(e,t){return s(this,void 0,void 0,(function*(){this.wsStore.isConnectionState(t,1)?(this.logger.info("Websocket connected",Object.assign(Object.assign({},f),{wsKey:t,livenet:this.isLivenet()})),this.emit("open",{wsKey:t,event:e})):this.wsStore.isConnectionState(t,4)&&(this.logger.info("Websocket reconnected",Object.assign(Object.assign({},f),{wsKey:t})),this.emit("reconnected",{wsKey:t,event:e})),this.setWsState(t,2),yield this.requestTryAuthenticate(t),this.requestSubscribeTopics(t,[...this.wsStore.getTopics(t)]),this.wsStore.get(t,!0).activePingTimer=setInterval((()=>this.ping(t)),this.options.pingInterval)}))}onWsMessage(e,t){const r=JSON.parse(e&&e.data||e);r.channel?this.onWsMessageUpdate(r):(this.logger.debug("Websocket event: ",e.data||e),this.onWsMessageResponse(r,t))}onWsError(e,t){this.parseWsError("Websocket error",e,t),this.wsStore.isConnectionState(t,2)&&this.emit("error",e)}onWsClose(e,t){this.logger.info("Websocket connection closed",Object.assign(Object.assign({},f),{wsKey:t})),3!==this.wsStore.getConnectionState(t)?(this.reconnectWithDelay(t,this.options.reconnectTimeout),this.emit("reconnect")):(this.setWsState(t,0),this.emit("close"))}onWsMessageResponse(e,t){h.isWsPong(e)?(this.logger.silly("Received pong",Object.assign(Object.assign({},f),{wsKey:t})),this.clearPongTimer(t)):this.emit("response",e)}onWsMessageUpdate(e){this.emit("update",e)}getWs(e){return this.wsStore.getWs(e)}setWsState(e,t){this.wsStore.setConnectionState(e,t)}getWsKeyForTopic(e){return t.wsKeyGeneral}}t.WebsocketClient=g},868:(e,t,r)=>{e.exports=r(867)},155:(e,t,r)=>{"use strict";var s=r(30),n=r(79),i=r(687),o=r(512),a=r(791),u=r(924),c=r(903),p=r(971);e.exports=function(e){return new Promise((function(t,r){var h=e.data,l=e.headers;s.isFormData(h)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(d+":"+g)}var m=a(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),o(m,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var s="getAllResponseHeaders"in f?u(f.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:s,config:e,request:f};n(t,r,i),f=null}},f.onabort=function(){f&&(r(p("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(p("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(p(t,e,"ECONNABORTED",f)),f=null},s.isStandardBrowserEnv()){var y=(e.withCredentials||c(m))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;y&&(l[e.xsrfHeaderName]=y)}if("setRequestHeader"in f&&s.forEach(l,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete l[t]:f.setRequestHeader(t,e)})),s.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),h||(h=null),f.send(h)}))}},867:(e,t,r)=>{"use strict";var s=r(30),n=r(843),i=r(891),o=r(316);function a(e){var t=new i(e),r=n(i.prototype.request,t);return s.extend(r,i.prototype,t),s.extend(r,t),r}var u=a(r(457));u.Axios=i,u.create=function(e){return a(o(u.defaults,e))},u.Cancel=r(266),u.CancelToken=r(747),u.isCancel=r(416),u.all=function(e){return Promise.all(e)},u.spread=r(545),u.isAxiosError=r(232),e.exports=u,e.exports.default=u},266:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},747:(e,t,r)=>{"use strict";var s=r(266);function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new s(e),t(r.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},e.exports=n},416:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},891:(e,t,r)=>{"use strict";var s=r(30),n=r(512),i=r(36),o=r(884),a=r(316);function u(e){this.defaults=e,this.interceptors={request:new i,response:new i}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},u.prototype.getUri=function(e){return e=a(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},s.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),s.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,s){return this.request(a(s||{},{method:e,url:t,data:r}))}})),e.exports=u},36:(e,t,r)=>{"use strict";var s=r(30);function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){s.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},791:(e,t,r)=>{"use strict";var s=r(957),n=r(50);e.exports=function(e,t){return e&&!s(t)?n(e,t):t}},971:(e,t,r)=>{"use strict";var s=r(136);e.exports=function(e,t,r,n,i){var o=new Error(e);return s(o,t,r,n,i)}},884:(e,t,r)=>{"use strict";var s=r(30),n=r(630),i=r(416),o=r(457);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),s.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=n(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},136:e=>{"use strict";e.exports=function(e,t,r,s,n){return e.config=t,r&&(e.code=r),e.request=s,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},316:(e,t,r)=>{"use strict";var s=r(30);e.exports=function(e,t){t=t||{};var r={},n=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function u(e,t){return s.isPlainObject(e)&&s.isPlainObject(t)?s.merge(e,t):s.isPlainObject(t)?s.merge({},t):s.isArray(t)?t.slice():t}function c(n){s.isUndefined(t[n])?s.isUndefined(e[n])||(r[n]=u(void 0,e[n])):r[n]=u(e[n],t[n])}s.forEach(n,(function(e){s.isUndefined(t[e])||(r[e]=u(void 0,t[e]))})),s.forEach(i,c),s.forEach(o,(function(n){s.isUndefined(t[n])?s.isUndefined(e[n])||(r[n]=u(void 0,e[n])):r[n]=u(void 0,t[n])})),s.forEach(a,(function(s){s in t?r[s]=u(e[s],t[s]):s in e&&(r[s]=u(void 0,e[s]))}));var p=n.concat(i).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===p.indexOf(e)}));return s.forEach(h,c),r}},79:(e,t,r)=>{"use strict";var s=r(971);e.exports=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(s("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},630:(e,t,r)=>{"use strict";var s=r(30);e.exports=function(e,t,r){return s.forEach(r,(function(r){e=r(e,t)})),e}},457:(e,t,r)=>{"use strict";var s=r(30),n=r(122),i={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,u={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(a=r(155)),a),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),s.forEach(["post","put","patch"],(function(e){u.headers[e]=s.merge(i)})),e.exports=u},843:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),s=0;s<r.length;s++)r[s]=arguments[s];return e.apply(t,r)}}},512:(e,t,r)=>{"use strict";var s=r(30);function n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(s.isURLSearchParams(t))i=t.toString();else{var o=[];s.forEach(t,(function(e,t){null!=e&&(s.isArray(e)?t+="[]":e=[e],s.forEach(e,(function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),o.push(n(t)+"="+n(e))})))})),i=o.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},50:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},687:(e,t,r)=>{"use strict";var s=r(30);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,r,n,i,o){var a=[];a.push(e+"="+encodeURIComponent(t)),s.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),s.isString(n)&&a.push("path="+n),s.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},957:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},232:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},903:(e,t,r)=>{"use strict";var s=r(30);e.exports=s.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var s=e;return t&&(r.setAttribute("href",s),s=r.href),r.setAttribute("href",s),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=s.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},122:(e,t,r)=>{"use strict";var s=r(30);e.exports=function(e,t){s.forEach(e,(function(r,s){s!==t&&s.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[s])}))}},924:(e,t,r)=>{"use strict";var s=r(30),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,o={};return e?(s.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=s.trim(e.substr(0,i)).toLowerCase(),r=s.trim(e.substr(i+1)),t){if(o[t]&&n.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},545:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},30:(e,t,r)=>{"use strict";var s=r(843),n=Object.prototype.toString;function i(e){return"[object Array]"===n.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===n.call(e)}function p(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:u,isUndefined:o,isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:p,merge:function e(){var t={};function r(r,s){u(t[s])&&u(r)?t[s]=e(t[s],r):u(r)?t[s]=e({},r):i(r)?t[s]=r.slice():t[s]=r}for(var s=0,n=arguments.length;s<n;s++)p(arguments[s],r);return t},extend:function(e,t,r){return p(t,(function(t,n){e[n]=r&&"function"==typeof t?s(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},939:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,s){function n(r){e.removeListener(t,i),s(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}g(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,n)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function c(e,t,r,s){var n,i,o,c;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),void 0===o)o=i[t]=r,++e._eventsCount;else if("function"==typeof o?o=i[t]=s?[r,o]:[o,r]:s?o.unshift(r):o.push(r),(n=u(e))>0&&o.length>n&&!o.warned){o.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=e,p.type=t,p.count=o.length,c=p,console&&console.warn&&console.warn(c)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var s={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=p.bind(s);return n.listener=r,s.wrapFn=n,n}function l(e,t,r){var s=e._events;if(void 0===s)return[];var n=s[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):d(n,n.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),s=0;s<t;++s)r[s]=e[s];return r}function g(e,t,r,s){if("function"==typeof e.on)s.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(i){s.once&&e.removeEventListener(t,n),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)s(u,this,t);else{var c=u.length,p=d(u,c);for(r=0;r<c;++r)s(p[r],this,t)}return!0},i.prototype.addListener=function(e,t){return c(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return c(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,s,n,i,o;if(a(t),void 0===(s=this._events))return this;if(void 0===(r=s[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,n=i;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(s[e]=r[0]),void 0!==s.removeListener&&this.emit("removeListener",e,o||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,s;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,i=Object.keys(r);for(s=0;s<i.length;++s)"removeListener"!==(n=i[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},i.prototype.listeners=function(e){return l(this,e,!0)},i.prototype.rawListeners=function(e){return l(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},768:(e,t,r)=>{var s=null;"undefined"!=typeof WebSocket?s=WebSocket:"undefined"!=typeof MozWebSocket?s=MozWebSocket:void 0!==r.g?s=r.g.WebSocket||r.g.MozWebSocket:"undefined"!=typeof window?s=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(s=self.WebSocket||self.MozWebSocket),e.exports=s}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,r),i.exports}return r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r(856)})()}));
//# sourceMappingURL=ftxapi.map